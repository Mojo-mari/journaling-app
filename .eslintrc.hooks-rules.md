# React Hooks Rules - 再発防止ガイドライン

## 問題
条件付きの早期リターン（`if (...) return ...`）の後にReact Hooksを呼ぶと、「Rendered more hooks than during the previous render」エラーが発生します。

## 原因
React Hooksは常に同じ順序で、同じ回数呼ばれる必要があります。条件付きの早期リターンの後にフックを呼ぶと、レンダリングごとにフックの数が変わってしまいます。

## 解決方法
**すべてのフック（useState, useEffect, useRef, useLiveQuery, useSwipeなど）は、コンポーネントのトップレベルで、すべての早期リターンの前に呼ぶ必要があります。**

## 正しい例
```typescript
const MyComponent = () => {
  // ✅ すべてのフックを最初に呼ぶ
  const [state, setState] = useState();
  const data = useLiveQuery(...);
  const { ref } = useSwipe(...);
  
  // ✅ 早期リターンはフックの後
  if (data === undefined) {
    return <Loading />;
  }
  
  return <Content />;
};
```

## 間違った例
```typescript
const MyComponent = () => {
  const [state, setState] = useState();
  const data = useLiveQuery(...);
  
  // ❌ 早期リターンの後にフックを呼ぶ
  if (data === undefined) {
    return <Loading />;
  }
  
  const { ref } = useSwipe(...); // エラー！
  
  return <Content />;
};
```

## チェックリスト
新しいビューコンポーネントを作成する際は、以下を確認：
- [ ] すべてのフックがコンポーネントのトップレベルで呼ばれている
- [ ] 早期リターンはすべてのフックの後にある
- [ ] 条件分岐内でフックを呼んでいない


